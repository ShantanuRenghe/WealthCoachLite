<!-- templates/forward.html -->
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Wealth Coach - Investment Recommendation</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body class="bg-light">
  <div class="container py-5">
    <h2 class="mb-4">Investment Recommendation Engine</h2>
    <form id="investForm">
      <div class="mb-3">
        <label class="form-label">Preferred Investment Types</label><br>
        <div class="form-check form-check-inline">
          <input class="form-check-input" type="checkbox" value="Equity" name="investment_type">
          <label class="form-check-label">Equity</label>
        </div>
        <div class="form-check form-check-inline">
          <input class="form-check-input" type="checkbox" value="Bonds" name="investment_type">
          <label class="form-check-label">Bonds</label>
        </div>
        <div class="form-check form-check-inline">
          <input class="form-check-input" type="checkbox" value="Gold" name="investment_type">
          <label class="form-check-label">Gold</label>
        </div>
        <div class="form-check form-check-inline">
          <input class="form-check-input" type="checkbox" value="Hybrid" name="investment_type">
          <label class="form-check-label">Hybrid</label>
        </div>
      </div>

      <div class="mb-3">
        <label for="expected_return_pct" class="form-label">Expected Return (%)</label>
        <input type="number" step="0.1" class="form-control" id="expected_return_pct" required>
      </div>

      <div class="mb-3">
        <label for="investment_horizon_years" class="form-label">Investment Horizon (Years)</label>
        <input type="number" class="form-control" id="investment_horizon_years" required>
      </div>

      <div class="mb-3">
        <label for="liquidity_need" class="form-label">Liquidity Need</label>
        <select class="form-select" id="liquidity_need">
          <option value="Low">Low</option>
          <option value="Medium" selected>Medium</option>
          <option value="High">High</option>
        </select>
      </div>

      <button type="submit" class="btn btn-primary">Get Recommendations</button>
    </form>

    <hr class="my-4">
    <div id="result"></div>
  </div>

  <script>
    document.getElementById("investForm").addEventListener("submit", async function(e) {
      e.preventDefault();
      const types = [...document.querySelectorAll('input[name="investment_type"]:checked')].map(el => el.value);
      const data = {
        investment_type: types,
        expected_return_pct: parseFloat(document.getElementById("expected_return_pct").value),
        investment_horizon_years: parseInt(document.getElementById("investment_horizon_years").value),
        liquidity_need: document.getElementById("liquidity_need").value
      };

      const response = await fetch("/recommend", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify(data)
      });

      const result = await response.json();
      const resultDiv = document.getElementById("result");

      if (result.recommendations.length === 0) {
        resultDiv.innerHTML = `<div class="alert alert-warning">No recommendations found for the given preferences.</div>`;
        return;
      }

      let html = `
        <h4 class="mb-3">Inferred Risk Profile: 
          <span class="badge bg-info text-dark">${result.inferred_risk_profile}</span>
        </h4>
        <div class="row row-cols-1 row-cols-md-2 g-4">
      `;

      result.recommendations.forEach(rec => {
        html += `
          <div class="col">
            <div class="card h-100 shadow-sm">
              <div class="card-body">
                <h5 class="card-title">${rec.name}</h5>
                <h6 class="card-subtitle mb-2 text-muted">${rec.type} | ${rec.risk}</h6>
                <ul class="list-group list-group-flush mt-3">
                  <li class="list-group-item"><strong>Expected Return:</strong> ${rec.expected_return}%</li>
                  <li class="list-group-item"><strong>Horizon:</strong> ${rec.horizon} years</li>
                  <li class="list-group-item"><strong>Liquidity:</strong> ${rec.liquidity}</li>
                </ul>
                ${rec.notes.length > 0 ? `
                  <div class="mt-3 alert alert-warning">
                    ${rec.notes.map(n => `<div>${n}</div>`).join('')}
                  </div>` : ''}
              </div>
            </div>
          </div>
        `;
      });

      html += `</div>`;
      resultDiv.innerHTML = html;
    });
  </script>

</body>
</html>
